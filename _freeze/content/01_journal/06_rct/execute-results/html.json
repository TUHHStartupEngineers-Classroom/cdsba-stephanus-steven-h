{
  "hash": "5d43aa6c36f57100062427c3f78efca7",
  "result": {
    "markdown": "---\ntitle: \"Randomized Controlled Trials\"\nformat:\n  html:\n    self-contained: false\nauthor: \"Stephanus Steven Halimkesuma\"\ntoc: true\nexecute:\n  warning: false\n---\n\n::: {.cell hash='06_rct_cache/html/unnamed-chunk-1_4f1918ba868731839a968faf2cad8c14'}\n\n```{.r .cell-code}\n# Load required libraries\nlibrary(ggplot2)\nlibrary(dplyr)\n\n# Load the data\nabtest_online <- readRDS(\"E:/Master Study/TUHH/Wise 23-24/Causal Data Science for Business Analytics/Causal_Data_Science_Data/abtest_online.rds\")\n\n# Step 1: Check covariate balance across groups and plot\ncovariate_balance_plot <- ggplot(abtest_online, aes(x = purchase_amount, color = as.factor(chatbot))) +\n  geom_density() +\n  labs(title = \"Covariate Balance Check\",\n       x = \"Purchase Amount\",\n       color = \"Chatbot Group\")\n\nprint(covariate_balance_plot)\n```\n\n![](06_rct_files/figure-html/unnamed-chunk-1-1.png){width=672}\n\n```{.r .cell-code}\n# Step 2: Run regression to find the effect of chatbot on sales\nsales_regression <- lm(purchase_amount ~ chatbot + mobile_device + previous_visit, data = abtest_online)\nsummary(sales_regression)\n```\n\n\nCall:\nlm(formula = purchase_amount ~ chatbot + mobile_device + previous_visit, \n    data = abtest_online)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-25.414 -14.428  -8.435  12.559  64.584 \n\nCoefficients:\n                  Estimate Std. Error t value Pr(>|t|)    \n(Intercept)        15.2840     1.1227  13.614  < 2e-16 ***\nchatbotTRUE        -6.8488     1.1792  -5.808 8.49e-09 ***\nmobile_deviceTRUE  -0.8562     1.2642  -0.677  0.49841    \nprevious_visit      0.7792     0.2869   2.716  0.00673 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 18.6 on 996 degrees of freedom\nMultiple R-squared:  0.04243,\tAdjusted R-squared:  0.03954 \nF-statistic: 14.71 on 3 and 996 DF,  p-value: 2.228e-09\n\n```{.r .cell-code}\n# Step 3: Find subgroup-specific effects with interaction (exemplary group: mobile users)\ninteraction_model <- lm(purchase_amount ~ chatbot * mobile_device + previous_visit, data = abtest_online)\nsummary(interaction_model)\n```\n\n\nCall:\nlm(formula = purchase_amount ~ chatbot * mobile_device + previous_visit, \n    data = abtest_online)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-25.403 -14.450  -8.445  12.549  64.562 \n\nCoefficients:\n                              Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                   15.27384    1.19130  12.821  < 2e-16 ***\nchatbotTRUE                   -6.82837    1.42580  -4.789 1.93e-06 ***\nmobile_deviceTRUE             -0.82375    1.79309  -0.459  0.64605    \nprevious_visit                 0.77914    0.28711   2.714  0.00677 ** \nchatbotTRUE:mobile_deviceTRUE -0.06455    2.52907  -0.026  0.97964    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 18.6 on 995 degrees of freedom\nMultiple R-squared:  0.04243,\tAdjusted R-squared:  0.03858 \nF-statistic: 11.02 on 4 and 995 DF,  p-value: 9.485e-09\n\n```{.r .cell-code}\n# Step 4: Logistic regression for binary outcome (purchase)\nlogistic_regression <- glm(purchase ~ chatbot + mobile_device + previous_visit, data = abtest_online, family = \"binomial\")\nsummary(logistic_regression)\n```\n\n\nCall:\nglm(formula = purchase ~ chatbot + mobile_device + previous_visit, \n    family = \"binomial\", data = abtest_online)\n\nCoefficients:\n                  Estimate Std. Error z value Pr(>|z|)    \n(Intercept)       -0.22185    0.12347  -1.797  0.07237 .  \nchatbotTRUE       -0.96894    0.13564  -7.144 9.09e-13 ***\nmobile_deviceTRUE -0.07119    0.14530  -0.490  0.62417    \nprevious_visit     0.10606    0.03262   3.252  0.00115 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 1329.1  on 999  degrees of freedom\nResidual deviance: 1262.2  on 996  degrees of freedom\nAIC: 1270.2\n\nNumber of Fisher Scoring iterations: 4\n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}